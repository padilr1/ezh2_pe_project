---
title: ""
author: ""
date: ""
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggpubr)
library(gridExtra)
library(grid)
library(cowplot)
```

# Hindbrain

```{r, echo = FALSE, message=FALSE}
load("hindbrain_ezh2_gene_exp.RData")
load("se_dev.RData")
load("hindbrain_complete.RData")
gene_time_plot <- hindbrain_normalized_counts %>%
  ggplot(aes(x = weeks_post_conception, y = mean_gene_exp)) +
  geom_point() +
  geom_smooth(method="lm") +
  stat_cor(method = "pearson", cor.coef.name = "R") +
  labs(title = "",x="Weeks Post-conception",y="EZH2 Expression")
psi_time_plot <- se_dev %>%
  dplyr::filter(condition == "hindbrain") %>%
  group_by(weeks_post_conception) %>%
  mutate(mean_psi = mean(PSI)) %>%
  distinct(mean_psi, .keep_all = TRUE) %>%
  ggplot(aes(x = weeks_post_conception, y = mean_psi)) +
  geom_point() +
  labs(title = "", x = "Weeks Post-conception", y="EZH2-PE PSI") +
  geom_smooth(method="lm") +
  stat_cor(method = "pearson", cor.coef.name = "R")
gene_psi_plot <- hindbrain_complete %>%
  ggplot(aes(x = mean_psi, y = mean_gene_exp)) +
  geom_point() +
  geom_smooth(method="lm") +
  stat_cor(method = "pearson", cor.coef.name = "R") +
  labs(title = "",x="EZH2-PE PSI",y="EZH2 Expression")

plot_grid(gene_time_plot,psi_time_plot,gene_psi_plot,labels = "AUTO")

#figure <- ggarrange(h, g, ncol = 2, nrow = 1)
#annotate_figure(figure,bottom = textGrob("Weeks Post-conception", gp = gpar(cex = 1.0)))
```

# Forebrain

